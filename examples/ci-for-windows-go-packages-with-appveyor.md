+++
title = "CI for Windows Go Packages with AppVeyor"
date = 2014-07-09T17:43:00Z
updated = 2014-07-22T07:11:52Z
tags = ["Go", "testing", "programming", "golang"]
blogimport = true 
type = "post"
[author]
	name = "Nate Finch"
	uri = "https://plus.google.com/115818189328363361527"
+++

I recently needed to update my <a href="https://github.com/natefinch/npipe" target="_blank">npipe</a> package, and since I want it to be production quality, that means setting up CI, so that people using my package can know it's passing tests. &nbsp;Normally I'd use Travis CI or Drone.io for that, but npipe is a Windows-only Go package, and neither of the aforementioned services support running tests on Windows.<br /><br />With some googling, I saw that <a href="https://twitter.com/nathany" target="_blank">Nathan Youngman</a>&nbsp;had worked with&nbsp;<a href="http://www.appveyor.com/" target="_blank">AppVeyor</a>&nbsp;to add Go support to their CI system. &nbsp;The example on the blog talks about making a build.cmd file in your repo to enable Go builds, but I found that you can easily set up a Go build without having to put CI-specific files in your repo.<br /><br />To get started with AppVeyor, just log into their site and tell it where to get your code (I logged in with Github, and it was easy to specify what repo of mine to test). &nbsp;Once you choose the repo, go to the Settings page on AppVeyor for that repo. &nbsp;Under the Environment tab on the left, set the clone directory to C:\GOPATH\src\&lt;your import path&gt; and set an environment variable called GOPATH to C:\GOPATH. &nbsp;Under the build tab, set the build type to "SCRIPT" and the script type to "CMD", and make the contents of the script <pre style="tab-size: 4;">go get -v -d -t &lt;your import path&gt;/...</pre> (this will download the dependencies for your package). &nbsp;In the test tab, set the test type to "SCRIPT", the script type to "CMD" and the script contents to <pre style="tab-size: 4;">go test -v -cover ./...</pre> &nbsp;(this will run all the tests in verbose mode and also output the test coverage).<br /><br />That's pretty much it. &nbsp;AppVeyor will automatically run a build on commits, like you'd expect. &nbsp;You can watch the progress on a console output on their page, and get a pretty little badge from the badges page. &nbsp;It's free for open source projects, and seems relatively responsive from my admittedly limited experience.<br /><br />This is a great boon for Go developers, so you can be sure your code builds and passes tests on Windows, with very little work to set it up. &nbsp;I'm probably going to add this to all my production repos, even the ones that aren't Windows-only, to ensure my code works well on Windows as well as Linux.<br /><br /><br />
